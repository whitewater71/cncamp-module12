$ kubectl create ns simple
namespace/simple created

$ k create -f httpserver-deploy.yaml -n simple
deployment.apps/httpserver created

$ k apply -f simple.yaml -n simple
deployment.apps/simple created
service/simple created

$ k create -f istio-specs.yaml -n simple
virtualservice.networking.istio.io/simple created
gateway.networking.istio.io/simple created

$ ki get svc
NAME                   TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)                                                                      AGE
istio-egressgateway    ClusterIP      10.105.43.4      <none>        80/TCP,443/TCP                                                               2d16h
istio-ingressgateway   LoadBalancer   10.96.87.238     <pending>     15021:31427/TCP,80:30794/TCP,443:31970/TCP,31400:32215/TCP,15443:32067/TCP   2d16h
istiod                 ClusterIP      10.111.165.140   <none>        15010/TCP,15012/TCP,443/TCP,15014/TCP                                        2d16h

$ k create -f httpserver-deploy.yaml -n simple
deployment.apps/httpserver created

$ curl -H "Host: simple.cncamp.io" 10.96.87.238/healthz -v
*   Trying 10.96.87.238:80...
* TCP_NODELAY set
* Connected to 10.96.87.238 (10.96.87.238) port 80 (#0)
> GET /healthz HTTP/1.1
> Host: simple.cncamp.io
> User-Agent: curl/7.68.0
> Accept: */*
>
* Mark bundle as not supporting multiuse
< HTTP/1.1 200 OK
< date: Thu, 23 Dec 2021 07:43:21 GMT
< content-length: 3
< content-type: text/plain; charset=utf-8
< x-envoy-upstream-service-time: 2
< server: istio-envoy
<
ok
* Connection #0 to host 10.96.87.238 left intact

